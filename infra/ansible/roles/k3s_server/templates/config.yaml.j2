write-kubeconfig-mode: "0644"
cluster-init: true
disable-default-registry-endpoint: {{ k3s_disable_default_registry_endpoint | default(true) | bool | lower }}
flannel-iface: "{{ private_iface | default(k3s_flannel_iface_default) }}"
node-label:
  - "pool={{ node_pool_name | default('ctrl') }}"

disable:
{% for component in k3s_server_disable_components %}
  - {{ component }}
{% endfor %}

tls-san:
{% set sans = ([ansible_host, private_ip] + (k3s_extra_tls_sans | default([]))) | unique %}
{% for san in sans %}
  - "{{ san }}"
{% endfor %}

{% if node_taint is defined and node_taint | length > 0 %}
node-taint:
  - "{{ node_taint }}"
{% endif %}
